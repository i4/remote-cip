<!DOCTYPE html>
<html lang="en">

<head>
	<!--
	Copyright (c) 2013-2018 Antoine Martin <antoine@xpra.org>
	Copyright (c) 2014 Joshua Higgins <josh@kxes.net>
	Licensed under MPL 2.0
	-->

	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
	<!-- Bootstrap core CSS -->
	<link href="css/bootstrap.css" rel="stylesheet">
	<!-- Custom styles for this template -->
	<link href="css/signin.css" rel="stylesheet">
	<title>Remote SPiC-IDE via Xpra HTML5 Client</title>
	<link rel="shortcut icon" type="image/x-icon" href="favicon.ico">
	<link rel="icon" type="image/png" href="favicon.png">

	<script type="text/javascript" src="js/lib/es6-shim.js"></script>
	<script type="text/javascript" src="js/lib/jquery.min.js"></script>
	<script type="text/javascript" src="js/Utilities.js"></script>
	<script type="text/javascript" src="js/MediaSourceUtil.js"></script>
	<script type="text/javascript" src="js/lib/aurora/aurora.js"></script>
</head>

<body>
    <div class="container">

		<form class="form-signin" action="connect.php" method="post">

		  <img src="icons/xpra-logo.png" id="logo" alt="xpra logo">
		  <h2 class="form-signin-heading">SPiC-IDE via Xpra</h2>

		  <div id="alert-disconnect" class="alert alert-danger" role="alert" style="display:none;">
		  	<p>You were disconnected for the following reason:</p>
		  	<p><span id="disconnect-reason"></span></p>
		  </div>

		  <div class="form-group">
			<label for="user">Username</label>
			<input title="Username" type="text" class="form-control" name="user" id="user" placeholder="CIP User" size="16" maxlength="256">
		  </div>

		  <div class="form-group">
			<label for="password">Password</label>
			<input title="Password" type="password" class="form-control" name="password" id="password" placeholder="Password" size="16" maxlength="256">
		  </div>

		  <div class="form-group">
			<label for="keyboard_layout">Keyboard Layout</label>&emsp;
			<select id="keyboard_layout" name="keyboard_layout" class="form-control">
			  <option value="de">Germany</option>
			  <option value="us">English USA</option>
			  <option value="gb">United Kingdom</option>
			  <option value="fr">France</option>
			  <option value="" disabled=""></option>
			  <option value="ad">Andorra</option>
			  <option value="af">Afghanistan</option>
			  <option value="al">Albania</option>
			  <option value="ara">Arabic</option>
			  <option value="am">Armenia</option>
			  <option value="az">Azerbaijan</option>
			  <option value="bd">Bangladesh</option>
			  <option value="by">Belarus</option>
			  <option value="be">Belgium</option>
			  <option value="bt">Bhutan</option>
			  <option value="ba">Bosnia</option>
			  <option value="br">Brazil</option>
			  <option value="bg">Bulgaria</option>
			  <option value="kh">Cambodia</option>
			  <option value="ca">Canada</option>
			  <option value="cn">China</option>
			  <option value="cd">Congo,</option>
			  <option value="hr">Croatia</option>
			  <option value="cz">Czechia</option>
			  <option value="dk">Denmark</option>
			  <option value="epo">Esperanto</option>
			  <option value="ee">Estonia</option>
			  <option value="et">Ethiopia</option>
			  <option value="ir">Iran</option>
			  <option value="iq">Iraq</option>
			  <option value="fo">Faroe</option>
			  <option value="fi">Finland</option>
			  <option value="fr">France</option>
			  <option value="ge">Georgia</option>
			  <option value="gh">Ghana</option>
			  <option value="gr">Greece</option>
			  <option value="gn">Guinea</option>
			  <option value="hu">Hungary</option>
			  <option value="is">Iceland</option>
			  <option value="in">India</option>
			  <option value="ie">Ireland</option>
			  <option value="il">Israel</option>
			  <option value="it">Italy</option>
			  <option value="jp">Japan</option>
			  <option value="kz">Kazakhstan</option>
			  <option value="kr">Korea,</option>
			  <option value="kg">Kyrgyzstan</option>
			  <option value="latam">Latin</option>
			  <option value="lv">Latvia</option>
			  <option value="la">Laos</option>
			  <option value="lt">Lithuania</option>
			  <option value="mao">Maori</option>
			  <option value="mk">Macedonia</option>
			  <option value="mv">Maldives</option>
			  <option value="ml">Mali</option>
			  <option value="mt">Malta</option>
			  <option value="mn">Mongolia</option>
			  <option value="me">Montenegro</option>
			  <option value="ma">Morocco</option>
			  <option value="mm">Myanmar</option>
			  <option value="np">Nepal</option>
			  <option value="nl">Netherlands</option>
			  <option value="ng">Nigeria</option>
			  <option value="no">Norway</option>
			  <option value="pk">Pakistan</option>
			  <option value="pl">Poland</option>
			  <option value="pt">Portugal</option>
			  <option value="ro">Romania</option>
			  <option value="ru">Russia</option>
			  <option value="sn">Senegal</option>
			  <option value="rs">Serbia</option>
			  <option value="sk">Slovakia</option>
			  <option value="si">Slovenia</option>
			  <option value="za">South Africa</option>
			  <option value="es">Spain</option>
			  <option value="lk">Sri Lanka</option>
			  <option value="se">Sweden</option>
			  <option value="ch">Switzerland</option>
			  <option value="sy">Syria</option>
			  <option value="tw">Taiwan</option>
			  <option value="tj">Tajikistan</option>
			  <option value="tz">Tanzania</option>
			  <option value="th">Thailand</option>
			  <option value="tr">Turkey</option>
			  <option value="tm">Turkmenistan</option>
			  <option value="ua">Ukraine</option>
			  <option value="uz">Uzbekistan</option>
			  <option value="vn">Vietnam</option>
			</select>
		  </div>

		  <div class="form-group">
			<label for="application">Start</label>&emsp;
			<select id="application" name="application" class="form-control">
			  <optgroup label="Dekstop Environment">
				<option value="xfce">xfce (default)</option>
			  </optgroup>
			  <optgroup label="Application">
				<option value="xterm">xterm</option>
				<option value="spic-ide">SPiC IDE</option>
			  </optgroup>
			</select>
		  </div>

		  <div class="form-group">
		    <button type="submit" class="btn btn-primary" style="background-color: #b0242e; border-color: #8c1d25;">Connect</button>
		  </div>
		</form>



	</div> <!-- /container -->
    <div class="bg-image"></div>

<script type="text/javascript">

const applications = $("#application option").map(function() { return this.value; }).get();

const queryString = window.location.search;
const urlParams = new URLSearchParams(queryString);
const app = urlParams.get("app");

if(applications.includes(app)) {
	$("#application").val(app);

	if(app == "spic-ide") {
		$('div.bg-image').css('background-image', 'url(background-spic.jpg)');
		$("#logo").attr("src", "icons/xpra-logo-spic.png");
	}
}

$(document).ready(function() {
	var getparam = Utilities.getparam;
	var getboolparam = Utilities.getboolparam;

	var disconnect_reason = getparam("disconnect") || null;

	if(disconnect_reason) {
		document.getElementById("alert-disconnect").style.display = "block";
		document.getElementById("disconnect-reason").innerText = disconnect_reason;
	}

	var keyboard_layout = getparam("keyboard_layout");
	if (keyboard_layout==null) {
		keyboard_layout = Utilities.getKeyboardLayout();
		console.log(keyboard_layout);
	}
	document.getElementById('keyboard_layout').value = keyboard_layout;
	if (document.getElementById('keyboard_layout').value !== keyboard_layout) {
		document.getElementById('keyboard_layout').value = 'de';
	}
});

</script>

</body>
</html>
